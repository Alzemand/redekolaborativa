{{extend 'layout_rede.html'}}
{{if user != message:}}
<section class="w-full f-left">
    <!-- Apresentação do usuário -->
    <section class="f-left">
        <figure>
            {{if not user.avatar:}}
            <img src={{=URL('static', '/images/non_avatar.gif')}} width="168px" height="168px">
            {{else:}}
            <img src={{=URL(f='download', args=user.avatar)}} width="168px" height="168px">
            {{pass}}
        </figure>
        <b>{{=T("Available")}}:</b> {{=T(user.user_available)}}<br />
        {{if user.user_available == 'Yes':}}
        {{if user.availability:}}<b>{{=T("Availability")}}:</b> {{=', '.join(user.availability)}}<br />{{pass}}
        {{pass}}
    </section>
    <section>
        <p>
            <h1>{{=user.username}}</h1>
            <b>{{=T("Biography")}}</b><br>
            {{=user.bio or ''}}
        </p>
        <section class="redes_sociais">
           {{if networking:}}
           <b>{{=T("Social Networking")}}</b><br />
           {{for s in networking:}}
           <ul>
            {{if s.network_type == 'Twitter':}}
            <li>{{if is_url(s.network):}}<a href="{{=s.network}}" target="_blank">{{=s.network_type}}</a>{{else:}}<a href="http://twitter.com/{{=s.network}}" target="_blank">{{=s.network_type}}</a>{{pass}}</li>
            {{elif s.network_type == 'Facebook':}}
            <li>{{if is_url(s.network):}}<a href="{{=s.network}}" target="_blank">{{=s.network_type}}</a>{{else:}}<a href="http://facebook.com/{{=s.network}}" target="_blank">{{=s.network_type}}</a>{{pass}}</li>
            {{elif s.network_type == 'Google+':}}
            <li>{{if is_url(s.network):}}<a href="{{=s.network}}" target="_blank">{{=s.network_type}}</a>{{else:}}<a href="https://plus.google.com/{{=s.network}}/posts" target="_blank">{{=s.network_type}}</a>{{pass}}</li>
            {{elif s.network_type == 'LinkedIn':}}
            <li>{{if is_url(s.network):}}<a href="{{=s.network}}" target="_blank">{{=s.network_type}}</a>{{else:}}<a href="http://linkedin.com/in/{{=s.network}}" target="_blank">{{=s.network_type}}</a>{{pass}}</li>
            {{elif s.network_type == 'Skype':}}
            <li>{{if is_url(s.network):}}<a href="{{=s.network}}" target="_blank">{{=s.network_type}}</a>{{else:}}<a href="skype:{{=s.network}}?userinfo">{{=s.network_type}}</a>{{pass}}</li>
            {{else:}}
            <li>{{=s.network}}</li>
            {{pass}}
            </ul>
            {{pass}}
            {{pass}}
        </section>
    </section>
</section>
<!-- Informações pessoais -->
<section class="w-full f-left">
    <h3>{{=T("Personal Info")}}</h3>
    <ul>
        <li><b>{{=T("Name")}}:</b> {{=user.first_name}}{{=' '}}{{=user.last_name or ''}}</li>
        <li><b>{{=T("Age")}}:</b> {{=user.age or ''}}</li>
        <li><b>{{=T("Localization")}}:</b> {{=user.localization or ''}}</li>
        <li><b>{{=T("E-mail")}}:</b> {{=g_return_if_empty(user.email)}}</li>
    </ul>
</section>
<!-- Informações profissionais -->
<section class="w-full f-left">
   <h3>{{=T("Professional Info")}}</h3>
   {{if professions:}}
   {{for p in professions:}}
   <ul>
    <li><b>{{=T("Profession")}}:</b> {{=p.profession}}
        <ul>
            {{if len(competencies) >= 1:}}
            {{list_competencies=[i.competence for c in competencies for i in c if i.profession_id ==  p.id]}}
            <li><b>{{=T("Competencies")}}:</b> {{=', '.join(list_competencies)}}</li>
            {{pass}}
        </ul>
    </li>
    </ul>

    {{pass}}
    {{else:}}
    {{=T("None")}}<br />
    {{pass}}
</section>
<!-- Meus projetos -->
<section class="w-full f-left">
  
    {{if auth.user_id == user.id:}}
    <a class="btn" href="{{=URL('create_project')}}">{{=T("Create a new project!")}}</a>
    {{pass}}
    <br>
     <h3>{{=T("My Projects")}}</h3>
                {{if my_projects:}}
                    <ul>
                    {{for l in my_projects:}}
                        <li>
                            <a href={{=URL('projects', args=l.project_slug)}}>
                                {{=l.name}}
                            </a>
                        </li>
                    {{pass}}
                    </ul>
                    {{if len(my_projects) > 5:}}
                        {{=A(T('Read more'), _href="#")}}
                    {{pass}}

                {{else:}}
                    {{=T("None")}}
                {{pass}}
</section>
<!-- Projetos que eu colaboro -->
<section class="w-full f-left">
         <h3>{{=T("Projects I Colaborate")}}</h3>
                {{if colaborate_projects:}}
                <table>
                    {{for l in colaborate_projects:}}
                    <tr>
                        <td>
                        <a href={{=URL('projects', args=colaborate_projects[l].project_slug)}}>
                            {{=colaborate_projects[l].name}}
                        </a>
                        </td>                       
                        <td>
                        {{user_function = db((db.team_function.username == user.id)&(db.team_function.project_id == colaborate_projects[l].id)).select(db.team_function.role).as_list()}}
                            {{if user_function:}}
                            {{for x,y in user_function[0].iteritems():}}
                            {{=y}}
                            {{pass}}<br>
                            {{else:}}
                            {{=T("Undefined")}}<br>
                            {{pass}}
                        </td>
                    </tr>
                    {{pass}}
                </table>
                {{if len(colaborate_projects) > 5:}}
                {{=A(T('Read more'), _href="#")}}
                {{pass}}
                {{else:}}
                {{=T("None")}}
                {{pass}}
</section>

{{else:}}
    {{=user}}
{{pass}}
